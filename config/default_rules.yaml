rules:
  - id: aws-access-key-id
    description: AWS Access Key ID
    regex: (?i)AKIA[0-9A-Z]{16}
    entropy: 3.2
    tags: [aws, cloud]

  - id: aws-secret-access-key
    description: AWS Secret Access Key
    regex: (?i)[0-9a-zA-Z/+]{40}
    entropy: 4.0
    keywords: [aws_secret_access_key, secret_key]

  - id: github-pat-classic
    description: GitHub Personal Access Token (classic)
    regex: ghp_[0-9a-zA-Z]{36}
    entropy: 4.2

  - id: github-fine-grained-pat
    description: GitHub Fine-Grained PAT
    regex: github_pat_[0-9A-Za-z]{22}_[0-9A-Za-z]{53}
    entropy: 4.5

  - id: github-oauth
    description: GitHub OAuth Access Token
    regex: gho_[0-9a-zA-Z]{36}
    entropy: 4.2

  - id: stripe-secret-key
    description: Stripe Secret Key
    regex: sk_live_[0-9a-zA-Z]{24,}
    entropy: null

  - id: stripe-test-key
    description: Stripe Test Key (potential leak)
    regex: sk_test_[0-9a-zA-Z]{24,}
    entropy: null

  - id: google-api-key
    description: Google API Key
    regex: AIza[0-9A-Za-z\-_]{35}
    entropy: 3.8

  - id: google-oauth-client-secret
    description: Google OAuth2 Client Secret
    regex: (?i)(client_secret|oauth_client_secret)[\s:=]+['"]?[a-zA-Z0-9\-_]{24}['"]?
    entropy: 3.5

  - id: slack-token
    description: Slack Token / Webhook
    regex: xox[baprs]-[0-9]{10,12}-[0-9]{10,12}-[0-9]{10,12}-[a-z0-9]{32}
    entropy: 4.0

  - id: slack-webhook
    description: Slack Webhook URL
    regex: https://hooks\.slack\.com/services/T[0-9A-Z]{8,}/B[0-9A-Z]{8,}/[0-9a-zA-Z]{24}
    entropy: null

  - id: jwt
    description: JSON Web Token (JWT)
    regex: eyJ[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*
    entropy: 4.0
    keywords: [jwt, token]

  - id: rsa-private-key
    description: RSA Private Key (PEM)
    regex: -----BEGIN RSA PRIVATE KEY-----
    entropy: null

  - id: ec-private-key
    description: EC Private Key
    regex: -----BEGIN EC PRIVATE KEY-----
    entropy: null

  - id: openssh-private-key
    description: OpenSSH Private Key
    regex: -----BEGIN OPENSSH PRIVATE KEY-----
    entropy: null

  - id: dsa-private-key
    description: DSA Private Key
    regex: -----BEGIN DSA PRIVATE KEY-----
    entropy: null

  - id: openvpn-key
    description: OpenVPN Static Key
    regex: -----BEGIN OpenVPN Static key V1-----
    entropy: null

  - id: generic-password
    description: Generic password / secret assignment
    regex: (?i)(password|passwd|pwd|secret|api_key|apikey|token|auth_key|credential)[\s:=]+['"]?[^'"\s]{8,}['"]?
    entropy: 3.7
    keywords: [password, secret, key]

  - id: database-url
    description: Database Connection String
    regex: (?i)(postgres|postgresql|mysql|mongodb|redis|sqlserver)://[^:]+:[^@]+@[^/\s]+(/\w+)?
    entropy: 3.5

  - id: twilio-api-key
    description: Twilio API Key
    regex: SK[0-9a-fA-F]{32}
    entropy: 3.8

  - id: sendgrid-api-key
    description: SendGrid API Key
    regex: SG\.[0-9A-Za-z\-_]{22}\.[0-9A-Za-z\-_]{43}
    entropy: 4.0

  - id: mailgun-api-key
    description: Mailgun API Key
    regex: key-[0-9a-zA-Z]{32}
    entropy: 3.5

  - id: azure-storage-key
    description: Azure Storage Account Key
    regex: (?i)AccountKey=[a-zA-Z0-9+/]{88}==
    entropy: 3.8

  - id: heroku-api-key
    description: Heroku API Key
    regex: (?i)[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}
    entropy: 3.5
    keywords: [heroku]

  - id: npm-access-token
    description: npm Access Token
    regex: npm_[0-9a-zA-Z]{36}
    entropy: 4.0

  - id: pypi-upload-token
    description: PyPI Upload Token
    regex: pypi-AgEIcHlwaS5vcmc[A-Za-z0-9\-_]{50,}
    entropy: 4.2

  - id: docker-config-auth
    description: Docker Config Auth
    regex: (?i)"auth"[\s:]+['"]?[a-zA-Z0-9+/]{40,}={0,2}['"]?
    entropy: 3.8

  - id: gitlab-pat
    description: GitLab Personal Access Token
    regex: glpat-[0-9a-zA-Z\-_]{20}
    entropy: 4.0

  - id: generic-api-token
    description: Generic API Token/Key (high entropy)
    regex: (?i)(api[-_]?key|api[-_]?token|access[-_]?token|auth[-_]?token)[\s:=]+['"]?[a-zA-Z0-9\-_=]{32,}['"]?
    entropy: 4.0
    keywords: [api, token, key]

# Path exclusions (regex patterns to skip)
exclusions:
  - \.git/
  - node_modules/
  - \.venv/
  - venv/
  - __pycache__/
  - \.pytest_cache/
  - \.tox/
  - dist/
  - build/
  - \.egg-info/
  - \.min\.js$
  - \.min\.css$
  - \.lock$
  - package-lock\.json$
  - yarn\.lock$
  - Pipfile\.lock$
  - poetry\.lock$
  - \.jpg$
  - \.png$
  - \.gif$
  - \.svg$
  - \.ico$
  - \.pdf$
  - \.zip$
  - \.tar$
  - \.gz$
